# ComandX用户手册
## 1. 引言
### 1.1 标识
  本文档是ComandX开源云原生系统的用户使用说明文档，对应初始开源版本V1.0。  
       
### 1.2 系统概述
  ComandX是可观测的界面化的运维解决方案，它是BridgX和SchedulX的Web可视化展示界面，提供简洁易用的操作体验。

它具有如下关键特性：

1、支持集群创建和管理；

2、支持扩缩容任务；

3、支持K8s集群创建和管理；

4、支持服务部署和编排；

5、支持云服务器管理；

6、支持云账户管理；

7、支持费用管理；

8、支持Dashboard全局展示

### 1.3 体系架构
  ComandX系统由多个模块构成，用户可以通过该系统对BridgX和SchedulX进行界面化使用。Dashboard模块是用户方便的查看使用的云资源情况，包括活跃集群、运行任务、任务数量、集群运行总时长等信息；扩缩容模块可以使用户在有扩容或缩容需求时，快速建立扩缩容任务，并且可以对扩容容任务进行管理；集群管理模块可以使用户根据业务需要定义适配的集群模板，并且可以对集群模板进行管理；K8s集群模块用户可以创建K8s集群，并申请实例，对K8s集群和实例进行管理；服务部署模块可以使用户在机器上部署服务和镜像；云服务器模块帮助客户管理自己申请的服务器资源；云厂商账户模块可以帮助客户管理不同云厂商的账户信息；费用管理模块使用户可以看到自已云资源的成本费用情况；账户管理模块可以帮助用户管理子账户，对子账户进行增删改查。
### 1.4 文档概述
  本文是ComandX系统的用户手册，详细介绍了ComandX的使用方法。欢迎任何人阅读和使用本文档，并将其提供给其他对ComandX平台感兴趣的同学。
### 1.5 名词解释

<table>
  <tr>
    <td>序号</td>
    <td>术语</td>
    <td>定义</td>
  </tr>
  <tr>
    <td>1</td>
    <td>集群</td>
    <td>一组配置相同机器的共同模板</td>
  </tr>
  <tr>
    <td>2</td>
    <td>扩容</td>
    <td>增加云服务器的台数</td>
  </tr>
  <tr>
    <td>3</td>
    <td>缩容</td>
    <td>减少云服务器的台数</td>
  </tr>
  <tr>
    <td>4</td>
    <td>任务</td>
    <td>一个扩容或缩容的作业任务</td>
  </tr>
       
</table>




## 2. 软件综述
### 2.1 软件应用
  ComandX系统可用于构建组织内部IT基础设施，提供K8s容器管理、快速扩缩容、集群管理、任务管理、机器管理、费用管理等服务。
### 2.2 用户角色说明
  管理员、开发人员、业务人员
### 2.3 授权和使用
  ComandX遵循Apache License 2.0开源协议。用户可以自由下载并免费使用此系统。用户需要自行承担此使用此系统带来的风险。
## 3. 扩缩容任务
  扩缩容任务模块主要用于帮助用户根据自己的业务需求快速进行定量的扩容或缩容任务，并对任务的执行情况进行管理。
### 3.1 立即扩缩容
  立即扩缩容模块是进行扩缩容时的便捷入口，当客户有扩缩容任务时，选择好扩缩容的集群模板、扩缩容的数量以及类型，即可快速进行扩缩容任务。当创建的任务没有合适的集群时，也可以通过添加集群的快速入口进行配置。
![image](https://user-images.githubusercontent.com/94337797/145365065-083ea719-eb6a-4240-913e-133da5525974.png)


### 3.2 任务列表
  任务列表模块可以帮助用户对已经建立的任务进行管理，可以根据任务名、集群、状态进行搜索和筛查，快速查找感兴趣的任务。同时，通过新建按钮，也可以快速进入创建任务页面，进行新的任务创建。
![image](https://user-images.githubusercontent.com/94337797/145370140-50f90cf7-eec7-46f1-afa8-0a3e7a3f1278.png)


  如果对任务的描述感兴趣，可以通过点击任务ID查看，包括任务名称、执行集群、变更动作、变更的机器数、执行时间等信息。
![image](https://user-images.githubusercontent.com/94337797/145370755-666a6f53-70bf-4eaa-9895-72b891e3af49.png)


  如果对任务的执行细节感兴趣，可以点击执行明细，进行便捷查看，包括机器的IP、状态、开始时间、耗时等信息。
  ![image](https://user-images.githubusercontent.com/94337797/145371168-26932e6f-e587-4aba-b452-b03d45cccbf0.png)




## 4. 集群管理
  集群管理模块主要用于创建配置相同机器的配置模板，包括云厂商、网络配置、机器配置、系统配置等相同参数，并对创建的集群模板进行管理，增删查改等。
### 4.1 创建集群
  创建集群主要包括云厂商配置、网络配置、机器配置和系统配置4个步骤。  
  
  云厂商配置主要是进行集群名称、集群描述的填写以及云厂商和云账户的选择。再进行云账户选择时，应提前在云厂商账户模块提前录入用户的云账户信息。
![image](https://user-images.githubusercontent.com/94337797/145372110-7883014d-9ceb-44a5-b849-3d02d0fa637d.png)



  网络配置模块主要是对集群所属的云厂商的可用区域、可用区进行选择，以及所在的vpc网络、子网配置、安全组配置。如果还有合适的VPC、子网或安全组，则可以通过相应的左边的按钮快捷创建。如果需要进行公网访问，可以可以开启公网配置，设置带宽收费类型和最大的带宽。
![image](https://user-images.githubusercontent.com/94337797/145373899-3fe761a8-455f-4b6f-8365-a6ad57d0f44d.png)
 


  机器配置模块包括付费方式、机器规格、操作系统镜像、系统盘及数据盘的参数配置。
![image](https://user-images.githubusercontent.com/94337797/145374076-e54139f3-a336-4d70-844e-63dbf6a72851.png)

  系统配置是对通过该集群创建的机器进行加密。
![image](https://user-images.githubusercontent.com/94337797/145374319-faa22bf8-0e56-4b2c-9e07-f24c0c91f2fe.png)

  
### 4.2 集群列表
  集群列表提供对已经创建的集群进行管理的功能，可以通过集群名称、云厂商或Access Key信息进行选择和筛查，而且通过创建集群按钮，可以快速的进入创建集群页面，添加新的集群。
![image](https://user-images.githubusercontent.com/94337797/145374628-12b0e538-963a-4531-94d1-eba6be3455ae.png)


  如果对某个集训需要进行更改或删除，则可以先在列表的第一列进行选择，然后点击相应的编辑或删除按钮。
![image](https://user-images.githubusercontent.com/94337797/145374783-56ca5c5e-3c29-4237-8658-734eab236e8a.png)



## 5. K8s集群
  K8s集群模块提供集群列表、创建集群、申请实例、实例组列表、实例列表、实例申请单等功能，用户可以简便的操作K8s。
### 5.1 集群列表
集群列表模块提供对已有K8s集群的查询功能，可以根据ID、集群名称进行查询，可以显示每个集群的状态、ID、集群名称、CPU、内存、存储、集群机器、集群实例数等信息。
![image](https://user-images.githubusercontent.com/94337797/145389933-10a7e153-1533-4b4b-8db2-916cbbe41427.png)

如果需要创建新的集群，则点击创建集群按钮，根据提示配置参数，进行创建。
![image](https://user-images.githubusercontent.com/94337797/145390047-995953e9-150a-4ca2-919d-f423b2fbd264.png)

### 5.2 申请实例
申请实例模块可以帮助用户申请相同规格的实例，方便快速操作，并且可以同时申请多个实例组。
![image](https://user-images.githubusercontent.com/94337797/145390365-4d215953-6456-46a8-987f-f9595376353b.png)

### 5.3 实例组
实例组模块主要是对已经申请的实例组进行管理，查找、删除，并且可以对实例组直接进行扩缩容。
![image](https://user-images.githubusercontent.com/94337797/145390456-21ce4033-2ed8-42ec-8673-416e81b5dbdf.png)

### 5.4 实例列表
实例列表模块是对已经申请的实例进行管理，可以通过Pod IP或者宿主机IP进行查找特定的实例，可以删除或重启某个实例，同时提供了申请实例的快速入口。
![image](https://user-images.githubusercontent.com/94337797/145391087-8a156aa3-c670-41d2-b906-df346c3a8b75.png)

### 5.5 实例申请单
实例申请单模块主要记录每一次申请实例的过程，包括执行状态、流水号、所属集群、实例组、实例配置、变更实例数、执行耗时、申请人及创建时间等信息。
![image](https://user-images.githubusercontent.com/94337797/145391158-171bdcaa-bc7a-4516-9cac-87eef42f3422.png)


## 6. 服务部署
通过服务部署模块，用户可以进行服务镜像部署。
## 6.1 创建服务
通过配置服务名称以及服务类型创建服务
![image](https://user-images.githubusercontent.com/94337797/145392067-6a9115a6-3632-4cd4-9786-1c691b9e94d2.png)

## 6.2 服务列表
服务列表模块不仅可以查看某个特定的服务信息，而且可以进行扩缩容。
对服务进行扩缩容，在操作列表点击相应服务的扩缩容；
![image](https://user-images.githubusercontent.com/94337797/143419363-9293d820-cf3b-40e5-b88a-d5e7d727cd96.png)

在扩缩容页面，根据需求进行操作；
![image](https://user-images.githubusercontent.com/94337797/143419451-2811560b-905b-4e92-bc78-55f69f51dcd5.png)

查看服务扩缩容执行详情；
![image](https://user-images.githubusercontent.com/94337797/143419885-4f9c93d7-a96a-40c2-b37c-e061d7d95d56.png)

## 7. 云服务器
  云服务器模块，可以显示用户所有已经申请的云服务器信息，并且可以通过机器名、IP、云厂商等信息进行选择和筛查。
![image](https://user-images.githubusercontent.com/94337797/145394153-7135b8cc-2a89-4b47-9bd8-97fe5982e57c.png)


  如果对某个特定的机器详细感兴趣，可以通过点击相应的机器名称进行详细信息查看，包括实例ID、创建时间、云厂商、机器规格、镜像ID、系统盘类型及大小、数据盘类型大小及个数，网络配置包括VPC名称、子网名称、安全组名称、内网IP及公网IP等信息。
![image](https://user-images.githubusercontent.com/94337797/145394209-6e38efeb-f389-457b-98b0-a01e632d0c15.png)



## 8. 云厂商账户
  云厂商账户模块主要是管理客户的云账户信息，可以通过账户名称、云厂商、账户信息等进行查找和筛选。
![image](https://user-images.githubusercontent.com/94337797/145393256-ff937e45-3dad-4902-bb14-8a461d05014c.png)


  如果需要增加云账户，则可以点击添加云账户按钮，填写账户名称、云厂商以及账户的AccessKey和AccessKey Secret信息。
![image](https://user-images.githubusercontent.com/94337797/145393506-1766134f-d3d4-4665-b294-58f753180247.png)



## 9. 费用管理
  费用模块主要是用来对客户已经申请的云资源所花费的费用进行管理。客户可以查看所有机器的费用，也可以通过集群选择查看某个集群的费用，同时支持可以针对某天的费用进行查询。
![image](https://user-images.githubusercontent.com/94337797/145393641-bde407a8-2c0e-49e5-aad6-f6199aab920f.png)


## 10. 账户管理
  账户管理模块主要是用于对主账户和子账户进行进行管理，可以创建子账户、对子账户进行禁用和启用。
![image](https://user-images.githubusercontent.com/94337797/145393718-e87f59b7-b2ab-4ed7-a3ba-6158a94942fa.png)

  当需要创建子账号时，点击创建子账号按钮，通过添加用户名、密码来添加子账号。
  ![image](https://user-images.githubusercontent.com/94337797/145393795-150b0cad-83ba-4522-ba60-34a049859838.png)

